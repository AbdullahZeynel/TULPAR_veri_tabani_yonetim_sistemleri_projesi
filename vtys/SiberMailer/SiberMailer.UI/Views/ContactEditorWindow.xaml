<Window x:Class="SiberMailer.UI.Views.ContactEditorWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="{Binding WindowTitle}"
        Height="480" Width="450"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        MouseLeftButtonDown="Window_MouseLeftButtonDown">
    
    <Border Background="{DynamicResource PanelBackgroundBrush}"
            BorderBrush="{DynamicResource BorderBrush}"
            BorderThickness="1"
            CornerRadius="12">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>  <!-- Header -->
                <RowDefinition Height="*"/>     <!-- Content -->
                <RowDefinition Height="Auto"/>  <!-- Buttons -->
            </Grid.RowDefinitions>

            <!-- Header -->
            <Border Grid.Row="0" 
                    Background="{DynamicResource CardBackgroundBrush}"
                    CornerRadius="12,12,0,0"
                    Padding="20,15">
                <Grid>
                    <StackPanel>
                        <TextBlock Text="{Binding WindowTitle}"
                                   Foreground="{DynamicResource PrimaryTextBrush}"
                                   FontSize="18"
                                   FontWeight="SemiBold"/>
                        <TextBlock Text="{Binding WindowSubtitle}"
                                   Foreground="{DynamicResource SecondaryTextBrush}"
                                   FontSize="12"
                                   Margin="0,4,0,0"/>
                    </StackPanel>
                    <!-- Close Button -->
                    <Button Content="âœ•"
                            HorizontalAlignment="Right"
                            VerticalAlignment="Top"
                            Width="28" Height="28"
                            FontSize="12"
                            Cursor="Hand"
                            Click="CloseButton_Click">
                        <Button.Style>
                            <Style TargetType="Button">
                                <Setter Property="Background" Value="Transparent"/>
                                <Setter Property="Foreground" Value="{DynamicResource SecondaryTextBrush}"/>
                                <Setter Property="BorderThickness" Value="0"/>
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="Button">
                                            <Border x:Name="border" 
                                                    Background="{TemplateBinding Background}" 
                                                    CornerRadius="4">
                                                <ContentPresenter HorizontalAlignment="Center" 
                                                                  VerticalAlignment="Center"/>
                                            </Border>
                                            <ControlTemplate.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter TargetName="border" Property="Background" Value="{DynamicResource ErrorBrush}"/>
                                                    <Setter Property="Foreground" Value="White"/>
                                                </Trigger>
                                            </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </Button.Style>
                    </Button>
                </Grid>
            </Border>

            <!-- Form Content -->
            <ScrollViewer Grid.Row="1" 
                          VerticalScrollBarVisibility="Auto"
                          Padding="20">
                <StackPanel>
                    <!-- Email Field (Required) -->
                    <TextBlock Text="Email Address *"
                               Foreground="{DynamicResource PrimaryTextBrush}"
                               FontSize="12"
                               FontWeight="SemiBold"
                               Margin="0,0,0,8"/>
                    <TextBox Text="{Binding Email, UpdateSourceTrigger=PropertyChanged}"
                             Style="{DynamicResource ModernTextBoxStyle}"
                             Tag="email@example.com"
                             Margin="0,0,0,20"/>

                    <!-- Full Name Field -->
                    <TextBlock Text="Full Name"
                               Foreground="{DynamicResource PrimaryTextBrush}"
                               FontSize="12"
                               FontWeight="SemiBold"
                               Margin="0,0,0,8"/>
                    <TextBox Text="{Binding FullName, UpdateSourceTrigger=PropertyChanged}"
                             Style="{DynamicResource ModernTextBoxStyle}"
                             Tag="John Doe"
                             Margin="0,0,0,20"/>

                    <!-- Company Field -->
                    <TextBlock Text="Company"
                               Foreground="{DynamicResource PrimaryTextBrush}"
                               FontSize="12"
                               FontWeight="SemiBold"
                               Margin="0,0,0,8"/>
                    <TextBox Text="{Binding Company, UpdateSourceTrigger=PropertyChanged}"
                             Style="{DynamicResource ModernTextBoxStyle}"
                             Tag="Acme Inc."
                             Margin="0,0,0,20"/>

                    <!-- Status Dropdown -->
                    <TextBlock Text="Status"
                               Foreground="{DynamicResource PrimaryTextBrush}"
                               FontSize="12"
                               FontWeight="SemiBold"
                               Margin="0,0,0,8"/>
                    <ComboBox ItemsSource="{Binding StatusOptions}"
                              SelectedItem="{Binding Status}"
                              Style="{DynamicResource ModernComboBoxStyle}"
                              Height="38"
                              Margin="0,0,0,20"/>

                    <!-- Custom Data (JSON) -->
                    <TextBlock Text="Custom Data (JSON)"
                               Foreground="{DynamicResource PrimaryTextBrush}"
                               FontSize="12"
                               FontWeight="SemiBold"
                               Margin="0,0,0,8"/>
                    <TextBox Text="{Binding CustomData, UpdateSourceTrigger=PropertyChanged}"
                             Style="{DynamicResource ModernTextBoxStyle}"
                             AcceptsReturn="True"
                             TextWrapping="Wrap"
                             Height="80"
                             VerticalScrollBarVisibility="Auto"
                             Tag="Enter JSON data here..."/>
                </StackPanel>
            </ScrollViewer>

            <!-- Action Buttons -->
            <Border Grid.Row="2"
                    Background="{DynamicResource CardBackgroundBrush}"
                    CornerRadius="0,0,12,12"
                    Padding="20,15">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <!-- Error Message -->
                    <TextBlock Grid.Column="0"
                               Text="{Binding ErrorMessage}"
                               Foreground="{DynamicResource ErrorBrush}"
                               VerticalAlignment="Center"
                               TextWrapping="Wrap"
                               FontSize="12"/>

                    <!-- Cancel Button -->
                    <Button Grid.Column="1"
                            Content="Cancel"
                            Style="{DynamicResource ModernButtonStyle}"
                            Width="100"
                            Margin="0,0,10,0"
                            Click="CloseButton_Click"/>

                    <!-- Save Button -->
                    <Button Grid.Column="2"
                            Content="{Binding SaveButtonText}"
                            Style="{DynamicResource AccentButtonStyle}"
                            Width="120"
                            Command="{Binding SaveCommand}"/>
                </Grid>
            </Border>
        </Grid>
    </Border>
</Window>
